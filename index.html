<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>RX Boss – Florida Prescribed Burn GO / NO-GO</title>

<style>
  :root {
    --bg: radial-gradient(circle at top, #2a0d0d, #0b0505 60%);
    --card: #160909;
    --border: #3a1414;
    --text: #f4eaea;
    --muted: #c9a3a3;
    --good: #2ecc71;
    --bad: #ff5c5c;
    --accent: #ff6b3d;
  }

  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    background: var(--bg);
    color: var(--text);
  }

  header {
    padding: 32px;
    max-width: 1200px;
    margin: auto;
  }

  h1 {
    margin: 0 0 6px 0;
    font-size: 34px;
    color: var(--accent);
  }

  header p {
    margin: 0;
    color: var(--muted);
  }

  main {
    max-width: 1200px;
    margin: auto;
    padding: 0 32px 60px;
  }

  .cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 16px;
  }

  .card {
    background: linear-gradient(180deg, #1d0b0b, #120707);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 16px;
    box-shadow: 0 0 0 1px #000 inset;
  }

  .card h3 {
    margin: 0 0 6px;
    font-size: 18px;
  }

  .pill {
    float: right;
    padding: 4px 10px;
    border-radius: 999px;
    font-size: 12px;
    font-weight: 600;
    border: 1px solid;
  }

  .go { color: var(--good); border-color: var(--good); }
  .nogo { color: var(--bad); border-color: var(--bad); }

  .row {
    font-size: 13px;
    margin: 4px 0;
    color: var(--muted);
  }

  .row strong { color: var(--text); }

  .score {
    margin-top: 10px;
    height: 6px;
    background: #2a1212;
    border-radius: 999px;
    overflow: hidden;
  }

  .score > div {
    height: 100%;
    background: linear-gradient(90deg, #ff5c5c, #ff9f43);
  }

  footer {
    margin-top: 40px;
    color: #9b7777;
    font-size: 12px;
  }
</style>
</head>

<body>
<header>
  <h1>RX Boss</h1>
  <p>Florida Prescribed Burn GO / NO-GO · Daytime Weather Only · Fire-Focused</p>
</header>

<main>
  <div class="cards" id="cards"></div>

  <footer>
    Data source: api.weather.gov (grid + nearest station) ·
    Metrics use **DAYTIME RH & DAYTIME MIN MIXING HEIGHT ONLY**
  </footer>
</main>

<script>
/* ================= CONFIG ================= */

// Burn-relevant daytime window (Florida)
const DAY_START = 10; // 10 AM local
const DAY_END   = 17; // 5 PM local

// Thresholds (tune later)
const RH_MIN = 30;
const RH_MAX = 55;
const MIX_MIN_FT = 1700;
const WIND_MAX = 15;
const QPF_MAX = 0.10;

// Max cards shown
const MAX_TRACTS = 10;

/* ================= UTILITIES ================= */

function toLocal(dateISO, tz) {
  return new Date(new Date(dateISO).toLocaleString("en-US", { timeZone: tz }));
}

function isDaytime(d) {
  const h = d.getHours();
  return h >= DAY_START && h <= DAY_END;
}

function min(values) {
  return values.length ? Math.min(...values) : null;
}

/* ================= DEMO INPUT ================= */
/* Replace later with GeoJSON upload */

const demoTracts = [
  { id: "HT03", name: "Tract Homosassa", lat: 28.73572, lon: -82.57394 },
  { id: "CI29", name: "Tract Citrus",    lat: 28.71247, lon: -82.50771 },
  { id: "CI30", name: "Tract Citrus",    lat: 28.69323, lon: -82.48828 },
  { id: "RI06", name: "Tract Richloam",  lat: 28.52680, lon: -82.11180 },
  { id: "RI07", name: "Tract Richloam",  lat: 28.50116, lon: -82.13160 },
  { id: "RI10", name: "Tract Richloam",  lat: 28.50742, lon: -82.07259 },
  { id: "RI12", name: "Tract Richloam",  lat: 28.49360, lon: -82.07113 },
  { id: "RI09", name: "Tract Richloam",  lat: 28.52251, lon: -82.07378 },
  { id: "RI11", name: "Tract Richloam",  lat: 28.50063, lon: -82.09339 },
  { id: "RI08", name: "Tract Richloam",  lat: 28.52093, lon: -82.09525 }
];

/* ================= MOCK WEATHER ================= */
/* This simulates api.weather.gov until you wire live fetch */

function mockWeather(tz) {
  const hours = [];
  for (let i = 0; i < 24; i++) {
    const d = new Date();
    d.setHours(d.getHours() + i);
    hours.push({
      time: d.toISOString(),
      rh: 40 + Math.random() * 20,
      mix: 1500 + Math.random() * 1200,
      wind: 10 + Math.random() * 8,
      qpf: Math.random() * 0.05
    });
  }

  const daytime = hours.filter(h => isDaytime(toLocal(h.time, tz)));

  return {
    rhRange: [
      min(daytime.map(h => h.rh)),
      Math.max(...daytime.map(h => h.rh))
    ],
    mixMin: min(daytime.map(h => h.mix)),
    windMax: Math.max(...daytime.map(h => h.wind)),
    qpfSum: hours.reduce((s,h)=>s+h.qpf,0),
    tz
  };
}

/* ================= SCORING ================= */

function scoreBurn(w) {
  let score = 100;

  if (w.rhRange[0] < RH_MIN || w.rhRange[1] > RH_MAX) score -= 30;
  if (w.mixMin < MIX_MIN_FT) score -= 30;
  if (w.windMax > WIND_MAX) score -= 20;
  if (w.qpfSum > QPF_MAX) score -= 20;

  return Math.max(score, 0);
}

/* ================= RENDER ================= */

const cardsEl = document.getElementById("cards");

const results = demoTracts.map(t => {
  const w = mockWeather("America/New_York");
  const score = scoreBurn(w);
  return { ...t, w, score };
})
.filter(r => r.w.mixMin !== null)
.sort((a,b)=>b.score-a.score)
.slice(0, MAX_TRACTS);

for (const r of results) {
  const go = r.score >= 60;
  const c = document.createElement("div");
  c.className = "card";
  c.innerHTML = `
    <span class="pill ${go?"go":"nogo"}">${go?"GO":"NO-GO"}</span>
    <h3>${r.id} · ${r.name}</h3>

    <div class="row">Centroid: <strong>${r.lat.toFixed(5)}, ${r.lon.toFixed(5)}</strong></div>
    <div class="row">DAYTIME RH range: <strong>${r.w.rhRange[0].toFixed(0)}–${r.w.rhRange[1].toFixed(0)}%</strong></div>
    <div class="row">DAYTIME min mixing height: <strong>${r.w.mixMin.toFixed(0)} ft</strong></div>
    <div class="row">Wind max: <strong>${r.w.windMax.toFixed(1)} mph</strong></div>
    <div class="row">QPF next 24h: <strong>${r.w.qpfSum.toFixed(2)} in</strong></div>

    <div class="score"><div style="width:${r.score}%"></div></div>
    <div class="row">Burn Quality Score: <strong>${r.score}%</strong></div>
  `;
  cardsEl.appendChild(c);
}
</script>
</body>
</html>
